<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <style>
    body {
      width: 570px;
      padding: 15px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #fff;
    }

    h3 {
      margin-top: 0;
      color: #00d4ff;
      font-size: 16px;
      border-bottom: 2px solid #00d4ff;
      padding-bottom: 8px;
      text-align: center;
    }

    button {
      width: 100%;
      padding: 16px;
      margin-top: 15px;
      cursor: pointer;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-size: 14px;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }

    button:hover {
      background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(56, 239, 125, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    .info {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      padding: 12px;
      margin-top: 20px;
      font-size: 12px;
      color: #ccc;
      line-height: 1.5;
      text-align: center;
    }

    /* Mode Toggle Buttons */
    .mode-btn {
      background: rgba(255, 255, 255, 0.1);
      color: #aaa;
      transition: all 0.3s ease;
      box-shadow: none;
    }

    .mode-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(0);
      box-shadow: none;
    }

    .mode-btn.active {
      background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
      color: white;
      font-weight: bold;
      box-shadow: 0 4px 6px rgba(0, 212, 255, 0.3);
    }

    .mode-btn.active:hover {
      background: linear-gradient(135deg, #0099cc 0%, #00d4ff 100%);
    }

    /* Textarea */
    #plateInput {
      width: 100%;
      min-height: 120px;
      padding: 10px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 6px;
      resize: vertical;
      box-sizing: border-box;
      outline: none;
    }

    #plateInput:focus {
      border-color: #00d4ff;
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
    }

    /* Minimized Input Mode */
    #minimizedInput button:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(0);
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.4);
    }

    /* Result Cards */
    .result-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 6px;
      padding: 8px 12px;
      margin-bottom: 6px;
      border-left: 4px solid;
      transition: all 0.2s ease;
    }

    .result-card:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateX(2px);
    }

    .result-card.tow {
      background-color: rgba(255, 82, 82, 0.15);
      border-left-color: #ff5252;
    }

    .result-card.fine {
      background-color: rgba(255, 193, 7, 0.15);
      border-left-color: #ffc107;
    }

    .result-card.warning {
      background-color: rgba(76, 175, 80, 0.15);
      border-left-color: #4caf50;
    }

    .result-plate {
      font-size: 14px;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      letter-spacing: 1px;
    }

    .result-status {
      font-size: 12px;
      font-weight: bold;
      margin-top: 4px;
    }

    .result-card.tow .result-status {
      color: #ff5252;
    }

    .result-card.fine .result-status {
      color: #ffc107;
    }

    .result-card.warning .result-status {
      color: #4caf50;
    }

    .result-details {
      font-size: 11px;
      color: #ccc;
      margin-top: 3px;
      line-height: 1.3;
    }

    /* Scrollbar */
    #resultsList::-webkit-scrollbar {
      width: 8px;
    }

    #resultsList::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 4px;
    }

    #resultsList::-webkit-scrollbar-thumb {
      background: rgba(0, 212, 255, 0.3);
      border-radius: 4px;
    }

    #resultsList::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 212, 255, 0.5);
    }

    /* Filter Buttons */
    .filter-btn {
      padding: 6px 12px;
      font-size: 11px;
      border: 2px solid;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: bold;
      margin: 0;
    }

    .filter-btn.tow {
      border-color: #ff5252;
      background: rgba(255, 82, 82, 0.2);
      color: #ff5252;
    }

    .filter-btn.tow.active {
      background: #ff5252;
      color: white;
    }

    .filter-btn.fine {
      border-color: #ffc107;
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
    }

    .filter-btn.fine.active {
      background: #ffc107;
      color: #333;
    }

    .filter-btn.warning {
      border-color: #4caf50;
      background: rgba(76, 175, 80, 0.2);
      color: #4caf50;
    }

    .filter-btn.warning.active {
      background: #4caf50;
      color: white;
    }

    .filter-btn.active-pass {
      border-color: #ffc107;
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
    }

    .filter-btn.active-pass.active {
      background: #ffc107;
      color: #333;
    }

    /* Expandable violation details */
    .violation-details {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      display: none;
    }

    .violation-details.expanded {
      display: block;
    }

    .violation-details table {
      width: 100%;
      font-size: 10px;
      border-collapse: collapse;
      margin-top: 5px;
    }

    .violation-details th {
      text-align: left;
      padding: 4px;
      background: rgba(0, 0, 0, 0.2);
      color: #00d4ff;
      font-weight: bold;
    }

    .violation-details td {
      padding: 4px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .expand-btn {
      font-size: 10px;
      color: #00d4ff;
      cursor: pointer;
      text-decoration: underline;
      margin-top: 4px;
      display: inline-block;
    }

    .expand-btn:hover {
      color: #00a8cc;
    }
  </style>
</head>

<body>
  <h3>üìä Pass 10x Report Generator</h3>

  <!-- Mode Toggle Buttons -->
  <div id="modeToggle" style="display: flex; gap: 8px; margin-top: 15px;">
    <button id="checkModeBtn" class="mode-btn active" style="flex: 1; padding: 12px; margin: 0;">
      üöó Check Plates
    </button>
    <button id="reportModeBtn" class="mode-btn" style="flex: 1; padding: 12px; margin: 0;">
      üìä Generate Report
    </button>
  </div>

  <!-- Check Plates Mode Container -->
  <div id="checkModeContainer">
    <div style="margin-top: 15px;">
      <!-- Input Section -->
      <div id="inputSection" style="position: relative;">
        <textarea id="plateInput" placeholder="Enter license plates..."></textarea>
        <div style="font-size: 11px; color: #aaa; margin-top: 5px; line-height: 1.4;">
          Enter license plates (one per line, or separated by commas). Max 100 plates. Letters and numbers only.
          <a href="#" id="showExample" style="color: #00d4ff; text-decoration: none;">See example</a>
        </div>
      </div>

      <!-- Action Buttons -->
      <div id="actionButtons" style="display: flex; gap: 8px; margin-top: 12px;">
        <button id="checkPlatesBtn" style="flex: 2; margin: 0; padding: 14px;">
          üîç Check Plates
        </button>
        <button id="clearInputBtn" style="flex: 1; margin: 0; padding: 14px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
          Clear
        </button>
      </div>

      <!-- Loading Indicator -->
      <div id="checkStatus" class="info" style="display:none; color: #00d4ff; font-weight: bold;">
        ‚è≥ Checking plates...
      </div>

      <!-- Minimized Input Bar (shown when results are displayed) -->
      <div id="minimizedInput" style="display: none; margin-top: 15px;">
        <button id="newSearchBtn" style="
          width: 100%;
          padding: 10px;
          margin: 0;
          background: rgba(255, 255, 255, 0.1);
          border: 2px solid #00d4ff;
          color: #00d4ff;
        ">
          ‚Üê Back to Search
        </button>
      </div>

      <!-- Results Container -->
      <div id="resultsContainer" style="display: none; margin-top: 15px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <span style="font-size: 12px; color: #00d4ff; font-weight: bold;">
            Results (<span id="resultCount">0</span> plates)
          </span>
          <button id="downloadCSVBtn" style="
            margin: 0;
            padding: 8px 12px;
            font-size: 11px;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
          ">
            üì• Download CSV
          </button>
        </div>

        <!-- Filter Buttons -->
        <div style="display: flex; gap: 6px; margin-bottom: 10px;">
          <button id="filterTow" class="filter-btn tow active">üî¥ TOW</button>
          <button id="filterFine" class="filter-btn fine active">üü° FINE</button>
          <button id="filterWarning" class="filter-btn warning active">üü¢ WARNING</button>
          <button id="filterActivePass" class="filter-btn active-pass active">‚ö†Ô∏è ACTIVE PASS</button>
        </div>

        <div id="resultsList" style="
          max-height: 450px;
          overflow-y: auto;
          background: rgba(0, 0, 0, 0.2);
          border-radius: 6px;
          padding: 8px;
        ">
          <!-- Result cards will be dynamically inserted here -->
        </div>
      </div>

      <!-- Help Text -->
      <div id="checkHelpInfo" class="info">
        Enter plates to check their enforcement status.<br>
        Data is fetched from the current session.
      </div>
    </div>
  </div>

  <!-- Report Mode Container -->
  <div id="reportModeContainer" style="display: none;">
    <div style="margin-top: 15px; background: rgba(255, 255, 255, 0.05); border-radius: 6px; padding: 10px;">
      <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px; margin-bottom: 8px;">
        <input type="checkbox" id="excludeWarning0" style="margin-right: 8px; cursor: pointer;">
        <span>Exclude Warning# 0 or less</span>
      </label>
      <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
        <input type="checkbox" id="includeNotes" style="margin-right: 8px; cursor: pointer;">
        <span>Include Notes (non-violations)</span>
      </label>
    </div>

    <button id="prepPage">üì• Fetch & Download Report</button>

    <div id="status" class="info" style="display:none; color: #00d4ff; font-weight: bold;">
      ‚è≥ Processing... please wait.
    </div>

    <div id="helpInfo" class="info">
      One click to fetch 180 days of data,<br>
      process warnings, and save as CSV.
    </div>
  </div>

  <script src="popup.js"></script>
</body>

</html>